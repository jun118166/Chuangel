<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>我的订单</title>
		<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
		<meta content="telephone=no" name="format-detection">
		<link rel="stylesheet" href="css/style.rem.css" />
		<script type="text/javascript">
			window.addEventListener(('orientationchange' in window ? 'orientationchange' : 'resize'), (function() {
				function c() {
					var d = document.documentElement;
					var cw = d.clientWidth || 640;
					d.style.fontSize = (20 * (cw / 320)) > 40 ? 40 + 'px' : (20 * (cw / 320)) + 'px';
				}
				c();
				return c;
			})(), false);
		</script>
	</head>

	<body>
		<div class="wrapper" id="app" v-cloak>
			<ul class="wodedingdan">
				<li v-for="item in items">
					<div class="dingdanzt">
						<p><span>{{item.product}}</span><strong>{{item.statusName}}</strong></p>
					</div>
					<div class="dingdanxq">
						<a href="order-detail.html?oid={{item.OrderCode}}">
							<img :src="item.img">
							<p>订单号：{{item.OrderCode}}</p>
							<p>故障详情：{{item.trouble}}</p>
							<p>价格：<span>¥ {{item.Total_cost}}</span></p>
						</a>
					</div>
					<div class="dingdanBtn">
						<a v-if="item.Status!=0" href="javascript:void(0)" class="qxddBtn" @click="cancel(item.Id)">取消订单</a>
						<span v-if="item.Cost_status==1">{{item.coststatusname}}</span>
						<a v-if="item.Cost_status!=1&&item.Status!=0" href="javascript:void(0)" class="ljjfBtn" datas="{{item.Id}}">支付完成</a>
					</div>
				</li>
			</ul>
		</div>
	</body>
	<script src="js/jquery-1.7.2.min.js"></script>
	<script src="js/base.js"></script>
	<script src="js/vue.min.js"></script>
	<script>
		var vm = new Vue({
			el: "#app",
			data: {
				items: []
			},
			methods: {
				loadData: function() {
					var self = this;
					getData('order/getByPhone?phone=' + sessionStorage.getItem('phone'), function(res) {
						res.map(function(i) {
							i.statusName = getstatus(i.Status);
							i.img = 'img/' + getstatusImg(i.Status) + '.png';
							i.coststatusname = getcost(i.Cost_status);
							if(i.Detail) {
								i.trouble = JSON.parse(i.Detail)[0].troubleName;
								i.product = JSON.parse(i.Detail)[0].product;
							}
						});
						self.items = res;
					});
				},
				cancel: function(e) {
					jump("cancel.html?oid=" + e);
				}
			},
			ready: function() {
				this.loadData();
			}
		});
	</script>

</html>