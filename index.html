<!--
	作者：zhijun916@163.com
	时间：2016-10-23
	描述：首页信息
-->
<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
		<meta content="telephone=no" name="format-detection">
		<title>传天羽维修_手机维修_手机上门维修 - 传天羽维修_手机维修_苹果/安卓手机维修_手机上门维修</title>
		<link rel="stylesheet" href="css/style.rem.css" />
		<link rel="stylesheet" href="css/swiper-3.2.7.min.css" />
		<script type="text/javascript" src="//webapi.amap.com/maps?v=1.3&key=11be5d75018d5bf370f5c5bcab522eb8&plugin=AMap.Geocoder"></script>
		<script type="text/javascript">
			window.addEventListener(('orientationchange' in window ? 'orientationchange' : 'resize'), (function() {
				function c() {
					var d = document.documentElement;
					var cw = d.clientWidth || 640;
					d.style.fontSize = (20 * (cw / 320)) > 40 ? 40 + 'px' : (20 * (cw / 320)) + 'px';
				}
				c();
				return c;
			})(), false);
		</script>
	</head>

	<body>
		<div class="wrapper">
			<nav class="indextop">
				<a class="denglu" href="usercenter.html"></a>
			</nav>
			<div class="banner">
				<div class="swiper-container">
					<div class="swiper-wrapper">
						<div class="swiper-slide">
							<a href="#">
								<img src="img/banner.png" />
							</a>
						</div>
						<div class="swiper-slide">
							<a href="#">
								<img src="img/banner.png" />
							</a>
						</div>
						<div class="swiper-slide">
							<a href="#">
								<img src="img/banner.png" />
							</a>
						</div>
					</div>
					<div class="swiper-pagination"></div>
				</div>
			</div>
			<div class="baoxiuchaxun">
				<a href="#">保修状态查询</a>
			</div>
			<div class="wxbx mt20">
				<ul>
					<li>
						<a href="choice-phone.html">
							<strong>iPhone</strong>
							<span>手机维修</span>
							<img src="img/iphone.png">
						</a>
					</li>
					<li>
						<a href="#">
							<strong>Mac</strong>
							<span>系统安装</span>
							<img src="img/mac.png">
						</a>
					</li>
				</ul>
				<div class="kfzx">
					<img src="img/kfzx.png" />
					<span>客服</span>
				</div>
			</div>
			<!--  wxwb end  -->
			<div class="xiadan mt20">
				<img src="img/kjxd.png">
				<p>
					<strong>快捷下单</strong>
					<span>不知道什么问题，我们帮你解决</span>
				</p>
			</div>
			<!--  xiadan end  -->
			<div class="xinxi" style="display: none;">
				<div class="arrowtop"></div>
				<ul>
					<li>
						<input type="text" placeholder="请输入您的姓名" class="realName">
					</li>
					<li class="tishi v1-1tishi1 err_real_name" style="display: none;">请输入姓名</li>
					<li>
						<input type="tel" placeholder="请输入您的手机" class="phoneNum" id="txtMobile">
					</li>
					<li class="tishi v1-1tishi1 err_mobile" style="display: none;">请输入手机号码</li>
					<li class="yzmzm">
						<input type="text" placeholder="请输入图片验证码" class="imgcode_code" value="">
						<span class="imgcode_img shuaxin"></span>
					</li>
					<li class="tishi v1-1tishi1 err_imgcode" style="display: none;">请输入图片验证码</li>
					<li class="yzm">
						<input type="tel" placeholder="请输入短信验证码" class="userinfoYzm">
						<a href="javascript:void(0);" id="validCodeId">获取验证码</a>
					</li>
					<li class="tishi v1-1tishi1 err_validcode" style="display: none;">请输入手机验证码</li>
					<li class="selectadd">
						<p>
							<span>
								<select id="select_city">
									<option value="0">选择市</option>
								</select>
							</span>
						</p>
						<p>
							<select id="select_district" value="310101">
								<option value="0">选择区</option>
							</select>
						</p>
					</li>
					<li class="tishi v1-1tishi1 err_city_district" style="display: none;">请选择所在地区</li>
					<li class="xiangxidizhi">
						<div contenteditable="true" class="xiangxidizhi1 address" tabindex="0" onfocus="addressonfocus()" onblur="addressonblur()">请输入详细地址</div>
						<a contenteditable="false" id="address" class="loca" style="margin-right: 15px;"></a>
					</li>
					<li class="tishi v1-1tishi1 err_address" style="display: none;">请输入详细地址</li>
					<li class="tishi v1-1tishi1 err_coupons" style="display: none;"></li>
				</ul>
				<a class="chaxun done">立即下单</a>
			</div>
			<!--  xinxi end  -->
			<div class="shili mt20">
				<h2>传天羽维修实力</h2>
				<div class="swiper-container">
					<div class="swiper-wrapper">
						<div class="swiper-slide">
							<p>
								<img src="img/wxbz.png" />
								<span>维修保障</span>
								<strong></strong>
							</p>
							<p>
								<img src="img/hylx.png" />
								<span>行业领先</span>
								<strong></strong>
							</p>
							<p>
								<img src="img/jgtm.png" />
								<span>价格透明</span>
								<strong></strong>
							</p>
						</div>
						<div class="swiper-slide">
							<p>
								<img src="img/wxbz.png" />
								<span>维修保障</span>
								<strong></strong>
							</p>
							<p>
								<img src="img/hylx.png" />
								<span>行业领先</span>
								<strong></strong>
							</p>
							<p>
								<img src="img/jgtm.png" />
								<span>价格透明</span>
								<strong></strong>
							</p>
						</div>
					</div>
					<div class="swiper-pagination"></div>
				</div>
			</div>
			<div class="kefurexian mt20">
				<a href="tel:400-837-799">
					<img src="img/kfrx.png" />
				</a>
			</div>
			<footer class="footer">
				<ul>
					<li>
						<a href="aboutus.html">关于我们</a>
						<span></span>
					</li>
					<li>
						<a href="article.html?type=service">维修流程</a>
						<span></span>
					</li>
					<li>
						<a href="article.html?type=protocol">用户协议</a>
						<span></span>
					</li>
				</ul>
				<p>传天羽 苏ICP备 123456号-1</p>
			</footer>
		</div>
		<div id="mengceng" style="position:absolute;width:100%;height:1360px;z-index:98;background-color:#ffffff;display:none;">
			<div id="framegoback" style="position:fixed;width:50px;height:50px;z-index:99999;top:1px;left:1px;"></div>
			<iframe id="test" src='http://m.amap.com/picker/?key=11be5d75018d5bf370f5c5bcab522eb8' style='width:100%;height:100%;position:fixed;top:0px;z-index:99;background-color:#ffffff;display:none;' frameborder="no" border="0" marginwidth="0" marginheight="0" scrolling="no" allowtransparency="yes"></iframe>
		</div>
		<input type="hidden" id="cityId" />
		<input type="hidden" id="disId" />
	</body>
	<script src="js/jquery-1.7.2.min.js"></script>
	<script src="js/base.js"></script>
	<script src="js/swiper-3.2.7.jquery.min.js"></script>
	<script>
		(function() {
			var iframe = document.getElementById('test').contentWindow;
			setTimeout(function() {
				iframe.postMessage('hello', 'http://m.amap.com/picker/');
			}, 1000)
			window.addEventListener("message", function(e) {
				window.setaddress(e.data.address)
			}, false);
		}());
	</script>
	<script>
		//弹出高德地图
		var mock = {
			log: function(result) {
				window.parent.setIFrameResult('log', result);
			}
		}
		console = mock;
		window.Konsole = {
			exec: function(code) {
				code = code || '';
				try {
					var result = window.eval(code);
					window.parent.setIFrameResult('result', result);
				} catch(e) {
					window.parent.setIFrameResult('error', e);
				}
			}
		}

		var swiper = new Swiper('.banner .swiper-container', {
			pagination: '.banner .swiper-pagination',
			paginationClickable: true,
			loop: true,
			autoplay: 3000
		});

		var slSwiper = new Swiper('.shili .swiper-container', {
			pagination: '.shili .swiper-pagination',
			paginationClickable: true,
			loop: true,
			autoplay: 3000
		});

		function addressonfocus() {
			if($('.address').html() == '请输入详细地址') {
				$('.address').html(' ');
				$('.address').css('color', '#333');
			}
		}

		function addressonblur() {
			if($('.address').html().length <= 0 || $('.address').html() == ' ') {
				$('.address').html('请输入详细地址');
				$('.address').css('color', '#888');
			}
		}

		function setaddress(addr) {
			$('div.address').html(addr);
			$('#test').hide();
			$('#mengceng').hide();
			$('.address').css('color', '#333');
		}

		$('#framegoback').click(function() {
			$('#test').hide();
			$('#mengceng').hide();
		});

		$(function() {
			var phone = localStorage.getItem('phone');
			if(phone){
				$('#txtMobile').val(phone);
				$('#txtMobile').attr('readonly','true');
			}
			
			getData('area/get', function(res) {
				for(i in res) {
					var obj = res[i];
					$('#select_city').append('<option value="' + obj.Id + '">' + obj.FullName + '</option>');
				}
			});

			$('#select_city').change(function() {
				var cityId = $(this).val();
				$('#cityId').val(cityId);
				getData(['area/get', cityId], function(data) {
					var obj = eval(data);
					$('#select_district').empty();
					$('#select_district').append('<option value="0">选择区</option>');
					for(i in obj) {
						$('#select_district').append('<option value="' + obj[i].Id + '">' + obj[i].FullName + '</option>');
					}
				});
			});
			$('#select_district').change(function() {
				var disId = $(this).val();
				$('#disId').val(disId);
			});

			$('a#address').click(function() {
				$('#test').show();
				$('#mengceng').show();
			});
			$('.v1-1tishi1').hide();
			$("span.shuaxin").html(createCode());
			//刷新图片
			$("span.shuaxin").click(function() {
				var code = createCode();
				$("span.shuaxin").html(code);
			});

			$(".xiadan").toggle(function() {
				$(".xinxi").fadeIn();
				$(this).find("p").addClass("xiadancur");
			}, function() {
				$(".xinxi").fadeOut();
				$(this).find("p").removeClass("xiadancur");
			})

			$('.done').on('click', function() {
				$('.v1-1tishi1').hide();
				var realName = $('.realName').val();
				var phoneNum = $('.phoneNum').val();
				var imgcode_code = $('.imgcode_code').val();
				var userinfoYzm = $('.userinfoYzm ').val();
				var city = $('#cityId').val();
				var distrcit = $('#disId').val();
				var cityName = $("#select_city").find("option:selected").text();
				var distrcitName = $("#select_district").find("option:selected").text();
				var address = $('.address').html();
				address = $.trim($('<div/>').html(address).text());
				var vcode = $('.vcode').val();
				var ref = "";
				if(realName == '') {
					$('.err_real_name').show();
					return false;
				} else {
					$('.err_real_name').hide();
				}
				if(phoneNum == '') {
					$('.err_mobile').text('请输入手机号码');
					$('.err_mobile').show();
					return false;
				} else {
					$('.err_mobile').hide();
				}
				if(!checkPhone(phoneNum)) {
					$('.err_mobile').text('请输入正确的手机号码');
					$('.err_mobile').show();
					return false;
				}
				if($('.imgcode_code').length) {
					if(imgcode_code == '') {
						$('.err_imgcode').text('请输入图片验证码');
						$('.err_imgcode').show();
						return false;
					} else {
						if(imgcode_code.length != 4 || (imgcode_code.toLowerCase() != $('.yzmzm span').html().toLowerCase())) {
							$('.err_imgcode').text('图形验证码错误');
							$('.err_imgcode').show();
							return false;
						}
					}
				}

				if($('.userinfoYzm').length) {
					if(userinfoYzm == '') {
						$('.err_validcode').show();
						return false;
					} else {
						if(userinfoYzm.length != 6) {
							$('.err_validcode').text('手机验证码错误');
							$('.err_validcode').show();
							return false;
						} else {
							$('.err_validcode').text('请输入手机验证码');
							$('.err_validcode').hide();
						}
					}
				}
				if(city == '' || distrcit == '') {
					$('.err_city_district').show();
					return false;
				} else {
					$('.err_city_district').hide();
				}
				if(!address || address == '请输入详细地址') {
					$('.err_address').show();
					return false;
				} else {
					$('.err_address').hide();
				}
				var param = {};
				param.Contacts = realName;
				param.Phone = phoneNum;
				param.City = city;
				param.District = distrcit;
				param.CityName = cityName;
				param.DistrictName = distrcitName;
				param.Street = address;
				param.Status = '5';
				postData('order/create', param, function(res) {
					localStorage.setItem('phone', phoneNum);
					window.location.href = "success.html";
				});
			});
			sendMsg($('#validCodeId'), 60);
		});
	</script>

</html>